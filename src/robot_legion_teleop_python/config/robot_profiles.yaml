# robot_profiles.yaml
# Proprietary - Vitruvian Systems LLC
#
# PURPOSE
# -------
# This YAML defines:
#   1) Which drive_profile THIS robot uses (robot-local setting)
#   2) The available profiles (diff, mecanum, etc.) and their parameters
#
# HOW THIS ENABLES A HETEROGENEOUS FLEET
# -------------------------------------
# Each robot chooses exactly ONE profile locally via 'drive_profile'.
# Teleop + motor_driver_node + heartbeat_node all read from this.
#
# That means you can clone the same repository onto any robot and only change
# ONE line (drive_profile) to match the robot's hardware + drive type.
#
# IMPORTANT
# ---------
# drive_profile is robot-local and should default to a safe option (diff drive)
# so a fresh clone doesn't unexpectedly strafe/rotate.

# --------------------------------------------------------------------
# ROBOT-LOCAL SELECTION (CHANGE THIS ON EACH ROBOT)
# --------------------------------------------------------------------
# Available profiles:
#   - diff_hbridge
#   - mecanum_tb6612
#
# Set this to the profile you want for THIS robot.
drive_profile: diff_hbridge

profiles:
  diff_hbridge:
    drive_type: diff_drive
    hardware: hbridge_2ch
    params:
      # Max speeds are used by motor_driver_node.py to normalize Twist commands.
      # Increase slowly while testing.
      max_linear_speed: 0.40
      max_angular_speed: 1.00

      # Optional inversion if one side is mirrored.
      invert_left: 1
      invert_right: 1

      # GPIO mapping example (update to your robot wiring)
      # (Your existing code already uses these pins.)
      gpio:
        left_dir: 23
        left_pwm: 18
        right_dir: 24
        right_pwm: 19

  mecanum_tb6612:
    drive_type: mecanum
    hardware: tb6612_4ch
    params:
      max_linear_speed: 0.50
      max_angular_speed: 1.20

      # k_omega tunes how much angular.z contributes to wheel outputs.
      # If rotation is too weak but DOES NOT strain, you can raise this
      # (try 0.35, 0.50, 0.70, etc.).
      k_omega: 0.22

      # Optional per-wheel inversion (fixes 'rotation strains / fights' issues).
      # Use 1 for normal, -1 to flip that wheel's direction.
      # Keys: fl, fr, rl, rr
      # Example (common): {fl: 1, fr: -1, rl: 1, rr: -1}
      wheel_invert: {fl: 1, fr: 1, rl: 1, rr: 1}

      # GPIO mapping example (update to your robot wiring)
      gpio:
        fl_dir: 5
        fl_pwm: 12
        fr_dir: 6
        fr_pwm: 13
        rl_dir: 16
        rl_pwm: 18
        rr_dir: 20
        rr_pwm: 19
